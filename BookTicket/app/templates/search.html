{% extends 'layout/base.html' %}

{% block content %}


<div class="container-custom mt-4" style="max-width: 1800px;">
    <div class="d-flex justify-content-center align-items-center">
        <h3 class="fw-bold btn btn-danger text-center">{{ departure }} → {{ destination }}</h3>
    </div>
</div>


<!-- Search Info and Filter Button -->
<div class="d-flex justify-content-between align-items-center mt-3">
    <span>{{ departure_date }} | {{ passenger }} Hành khách</span>
    <a href="/">
        <button class="btn btn-danger">Thay đổi tìm kiếm</button>
    </a>
</div>

<!-- Filter Section -->
<div class="row mt-4">
    <div class="col-md-3">
        <div class="border p-3 rounded">
            <button class="btn btn-danger w-100 mb-3">Đặt lại tất cả</button>

            <!-- Airline Filter -->
            <h6>Hãng hàng không</h6>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="vietnamAirlines">
                <label class="form-check-label" for="vietnamAirlines">Vietnam Airlines</label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="bambooAirways">
                <label class="form-check-label" for="bambooAirways">Bamboo Airways</label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="vietjetAir" checked>
                <label class="form-check-label" for="vietjetAir">Vietjet Air</label>
            </div>

            <!-- Flight Time Filter -->
            <h6 class="mt-3">Thời gian bay</h6>
            <h6 class="mt-2">Giờ cất cánh</h6>
            <form method="GET" action="/search">
                <!-- Ẩn các giá trị tìm kiếm hiện tại để giữ trạng thái -->
                <input type="hidden" name="departure" value="{{ departure }}">
                <input type="hidden" name="destination" value="{{ destination }}">
                <input type="hidden" name="departure-date" value="{{ departure_date }}">
                <input type="hidden" name="passengers" value="{{ passenger }}">

                <div class="d-flex flex-wrap">
                    <button class="btn btn-outline-secondary btn-sm m-1" name="time_range" value="0-6">00:00 -
                        06:00
                    </button>
                    <button class="btn btn-outline-secondary btn-sm m-1" name="time_range" value="6-12">06:00 -
                        12:00
                    </button>
                    <button class="btn btn-outline-secondary btn-sm m-1" name="time_range" value="12-18">12:00 -
                        18:00
                    </button>
                    <button class="btn btn-outline-secondary btn-sm m-1" name="time_range" value="18-24">18:00 -
                        24:00
                    </button>
                </div>
            </form>

            <!-- Landing Time Filter -->
            <h6 class="mt-2">Giờ hạ cánh</h6>
            <form method="GET" action="/search">
                <!-- Ẩn các giá trị tìm kiếm hiện tại để giữ trạng thái -->
                <input type="hidden" name="departure" value="{{ departure }}">
                <input type="hidden" name="destination" value="{{ destination }}">
                <input type="hidden" name="departure-date" value="{{ departure_date }}">
                <input type="hidden" name="passengers" value="{{ passenger }}">

                <div class="d-flex flex-wrap">
                    <button class="btn btn-outline-secondary btn-sm m-1" name="arrival_time_range" value="0-6">00:00 -
                        06:00
                    </button>
                    <button class="btn btn-outline-secondary btn-sm m-1" name="arrival_time_range" value="6-12">06:00 -
                        12:00
                    </button>
                    <button class="btn btn-outline-secondary btn-sm m-1" name="arrival_time_range" value="12-18">12:00 -
                        18:00
                    </button>
                    <button class="btn btn-outline-secondary btn-sm m-1" name="arrival_time_range" value="18-24">18:00 -
                        24:00
                    </button>
                </div>
            </form>


            <!-- Price Range Filter -->
            <h6 class="mt-3">Giá/hành khách</h6>
            <input type="range" class="form-range" min="1000000" max="10000000" value="5000000">

            <!-- Additional Filters -->
            <h6 class="mt-3">Tiện ích</h6>
            <select class="form-select mb-3">
                <option selected>Chọn tiện ích</option>
                <option value="1">Tiện ích 1</option>
                <option value="2">Tiện ích 2</option>
            </select>

            <h6 class="mt-3">Số điểm dừng</h6>
            <select class="form-select">
                <option selected>Chọn số điểm dừng</option>
                <option value="1">Không dừng</option>
                <option value="2">1 điểm dừng</option>
            </select>
        </div>
    </div>

    <!-- Flight Results Section -->

    <div class="col-md-9">
        {% if flights %}

        {% for f in flights %}
        <div class="container py-4">
            <!-- Flight Card -->
            <div class="row border p-3 mb-3">
                <div class="col-md-3 text-center">
                    <p class="mb-0">{{f.departure_time.strftime('%H:%M')}}</p>
                    <p class="text-muted">{{f.departure_airport}}<br>{{departure}}</p>
                </div>
                <div class="col-md-6 text-center">
                    <p class="text-muted">Thời gian bay: {{f.flight_time}}</p>
                    {% if intermediate_airport is none%}
                    <p class="mb-0">Bay thẳng</p>
                    {% else %}

                    <p>{{f.flight_code}} Khai thác bởi {{f.airline_name}}</p>
                    <a href="#">Chi tiết hành trình</a>
                    {% endif %}
                </div>
                <div class="col-md-3 text-center">
                    <p class="mb-0">{{f.arrival_time.strftime('%H:%M')}}</p>
                    <p class="text-muted">{{f.destination_airport}}<br>{{destination}}</p>
                </div>
                <div class="col-md-12 mt-3">
                    <div class="d-flex">
                        <div class="flex-grow-1 text-center border-end">
                            <p class="fw-bold text-primary">PHỔ THÔNG</p>
                            <p>Từ <span class="text-success">{{f.business_price}} </span></p>
                            <p class="text-muted">6 ghế còn lại</p>
                            <button class="btn btn-primary">Chọn</button>
                        </div>
                        <div class="flex-grow-1 text-center">
                            <p class="fw-bold text-warning">THƯƠNG GIA</p>
                            <p>Từ <span class="text-success">{{ f.economic_price }}</span></p>
                            <p class="text-muted">5 ghế còn lại</p>
                            <button class="btn btn-warning">Chọn</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        {% endfor %}
        {% else %}
        <p>Không tìm thấy chuyến bay nào phù hợp.</p>
        {% endif %}
    </div>


</div>
{% endblock %}